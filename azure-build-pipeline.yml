name: $(EmonsProjects.Version)-alpha.$(Rev:r)

variables:
  - name: EmonsProjects.Version
    value: 0.0.0
  - name: EmonsProjects.ProjectName
    value: RiseVocab
  - name: EmonsProjects.AppName
    value: DictionaryService
  - name: EmonsProjects.ContainerRegistryConnection
    value: Emon's Projects Container Registry
  - name: EmonsProjects.GithubConnection
    value: EmrahOner Github

trigger:
  - master

pr: none

pool:
  name: Hosted Ubuntu 1604

steps:
- task: Docker@2
  displayName: Login to Container Registry
  inputs:
    command: login
    containerRegistry: $(EmonsProjects.ContainerRegistryConnection)
- task: Docker@2
  displayName: Build and Push Docker Image
  inputs:
    command: buildAndPush
    dockerFile: dockerfile
    repository: $(EmonsProjects.ProjectName)/$(EmonsProjects.AppName)
    tags: |
     latest
     $(Build.BuildNumber)
- task: Docker@2
  displayName: Logout of Container Registry
  inputs:
    command: logout
    containerRegistry: $(EmonsProjects.ContainerRegistryConnection)
